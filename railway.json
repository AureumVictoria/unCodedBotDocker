{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "DOCKERFILE",
    "dockerfilePath": "Dockerfile"
  },
  "deploy": {
    "numReplicas": 1,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "services": [
    {
      "name": "postgres",
      "image": "postgres:16-alpine",
      "volumes": [
        {
          "mount": "/var/lib/postgresql/data",
          "name": "postgres-data"
        }
      ],
      "variables": {
        "POSTGRES_DB": "tradingbot",
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": {
          "generator": "password"
        }
      }
    },
    {
      "name": "trading-bot",
      "source": {
        "image": "aureumvictoria/trading-bot-secure:latest"
      },
      "variables": {
        "POSTGRES_HOST": {
          "fromService": "postgres",
          "type": "RAILWAY_PRIVATE_DOMAIN"
        },
        "POSTGRES_PORT": "5432",
        "POSTGRES_DB": "tradingbot",
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": {
          "fromService": "postgres",
          "envVarKey": "POSTGRES_PASSWORD"
        },
        "DOCKER_ENV": "true"
      }
    },
    {
      "name": "telegram-bot",
      "source": {
        "image": "aureumvictoria/unCodedBotDocker:latest"
      },
      "variables": {
        "POSTGRES_HOST": {
          "fromService": "postgres",
          "type": "RAILWAY_PRIVATE_DOMAIN"
        },
        "POSTGRES_PORT": "5432",
        "POSTGRES_DB": "tradingbot",
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": {
          "fromService": "postgres",
          "envVarKey": "POSTGRES_PASSWORD"
        }
      }
    }
  ]
}