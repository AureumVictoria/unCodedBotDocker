# UnCoded Trading Bot - Railway Konfiguration
[build]
builder = "NIXPACKS"

# Service 1: PostgreSQL Datenbank
[[services]]
name = "postgres"
image = "postgres:16-alpine"
restartPolicy = "on-failure"
  [services.postgres.variables]
  POSTGRES_DB = "tradingbot"
  POSTGRES_USER = "postgres"
  POSTGRES_PASSWORD = "${RAILWAY_PASSWORD}"
  [[services.postgres.volumes]]
  mount = "/var/lib/postgresql/data"
  name = "postgres-data"

# Service 2: Der Trading-Bot
[[services]]
name = "trading-bot"
image = "./"
restartPolicy = "on-failure"
  [services.trading-bot.variables]
  POSTGRES_HOST = "${postgres.RAILWAY_PRIVATE_DOMAIN}"
  POSTGRES_PORT = "5432"
  POSTGRES_DB = "tradingbot"
  POSTGRES_USER = "postgres"
  POSTGRES_PASSWORD = "${postgres.POSTGRES_PASSWORD}"
  DOCKER_ENV = "true"

# Service 3: Der Telegram-Bot
[[services]]
name = "telegram-bot"
image = "./"
startCommand = "node tgbot.js"
restartPolicy = "on-failure"
  [services.telegram-bot.variables]
  POSTGRES_HOST = "${postgres.RAILWAY_PRIVATE_DOMAIN}"
  POSTGRES_PORT = "5432"
  POSTGRES_DB = "tradingbot"
  POSTGRES_USER = "postgres"
  POSTGRES_PASSWORD = "${postgres.POSTGRES_PASSWORD}"